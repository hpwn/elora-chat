############################################
# Elora-Chat Example Environment Variables
# Copy this to `.env` and adjust for your setup
############################################

# ---------------------------
# Backend / API
# ---------------------------

# Port the backend will listen on (default 8080)
PORT=8080

# Publicly accessible URL where the backend is reachable
# (used by the UI to configure API base)
DEPLOYED_URL=http://localhost:8080

# Comma-separated list of chat URLs (Twitch or YouTube live links)
# Example: CHAT_URLS=https://www.twitch.tv/rifftrax,https://www.youtube.com/watch?v=jfKfPfyJRdk
CHAT_URLS=

# Ingest driver: chatdownloader | gnasty
# - chatdownloader (default) uses the Python-based fetcher bundled with the app
# - gnasty runs an external process that writes NDJSON chat lines to stdout
ELORA_INGEST_DRIVER=chatdownloader

# ---------------------------
# gnasty (when ELORA_INGEST_DRIVER=gnasty)
# ---------------------------
# Path to the gnasty binary (inside the container if using Docker)
# e.g. /usr/local/bin/gnasty-chat (mount this path in docker run)
GNASTY_BIN=

# Extra args for gnasty (comma-separated)
# Common example: --stdout,--format,ndjson
GNASTY_ARGS=--stdout,--format,ndjson

# Restart backoff tuning (milliseconds)
GNASTY_BACKOFF_BASE_MS=1000
GNASTY_BACKOFF_MAX_MS=30000

# ---------------------------
# Auth / API Keys (optional for some features)
# ---------------------------
TWITCH_CLIENT_ID=
TWITCH_CLIENT_SECRET=
TWITCH_REDIRECT_URL=

YOUTUBE_API_KEY=

# ---------------------------
# SQLite Storage Configuration
# ---------------------------

# Mode: persistent (recommended) | ephemeral
# persistent = keeps DB at ELORA_DB_PATH across restarts
# ephemeral  = temp file (erased when container stops)
ELORA_DB_MODE=persistent

# Database file path (used when ELORA_DB_MODE=persistent)
# If using Docker, mount a volume at /data
ELORA_DB_PATH=/data/elora.db

# Connection settings
ELORA_DB_MAX_CONNS=16
ELORA_DB_BUSY_TIMEOUT_MS=5000

# Extra pragmas applied on connection (comma-separated key=value pairs)
# mmap_size speeds up large queries, cache_size negative = pages in KB, temp_store=MEMORY
ELORA_DB_PRAGMAS_EXTRA=mmap_size=268435456,cache_size=-100000,temp_store=MEMORY

# ---------------------------
# SQLite DB tailer (optional)
# ---------------------------

# Enable polling the SQLite DB for externally ingested chat rows (e.g., gnasty-chat)
ELORA_DB_TAIL_ENABLED=false
# Poll interval in milliseconds (aka ELORA_DB_TAIL_POLL_MS)
ELORA_DB_TAIL_INTERVAL_MS=1000
# Maximum number of rows fetched per poll
ELORA_DB_TAIL_BATCH=200
# Wrap chat WebSocket frames in a {type,data} envelope (optional)
ELORA_WS_ENVELOPE=true
ELORA_WS_DROP_EMPTY=true
